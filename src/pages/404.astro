---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Layout from '../layouts/Layout.astro';
import { Image } from "astro:assets";
import { getTranslations, getLangFromUrl } from '../i18n/ui';

import '../styles/main.scss';

// Enhanced language detection for 404 pages
const pathSegments = Astro.url.pathname.split("/").filter(segment => segment);
console.log('404 Page - Path segments:', pathSegments);

// Remove base path if present
const segments = pathSegments[0] === 'alirio' ? pathSegments.slice(1) : pathSegments;
console.log('404 Page - Segments after base removal:', segments);

// Check if first segment is a language code
let detectedLang = 'en';
if (segments.length > 0 && ['en', 'bs', 'sv', 'ar', 'ku', 'sy'].includes(segments[0])) {
  detectedLang = segments[0];
}

console.log('404 Page - Final detected language:', detectedLang);

const lang = detectedLang;
const { ui, content } = getTranslations(lang);

// Debug: Log the detected language and URL for troubleshooting
console.log('404 Page - Current URL:', Astro.url.pathname);
console.log('404 Page - Detected language:', lang);

// 404 page content translations
const errorContent = {
  en: {
    title: "Page Not Found",
    subtitle: "Oops! The page you're looking for doesn't exist.",
    description: "The page you're looking for might have been moved, deleted, or you entered the wrong URL.",
    backHome: "Back to Home",
    backHomeUrl: "/",
    errorCode: "404"
  },
  bs: {
    title: "Stranica nije pronađena",
    subtitle: "Ups! Stranica koju tražite ne postoji.",
    description: "Stranica koju tražite možda je premještena, obrisana ili ste unijeli pogrešan URL.",
    backHome: "Povratak na početnu",
    backHomeUrl: "/bs/",
    errorCode: "404"
  },
  sv: {
    title: "Sidan hittades inte",
    subtitle: "Oj! Sidan du letar efter finns inte.",
    description: "Sidan du letar efter kan ha flyttats, tagits bort eller du angav fel URL.",
    backHome: "Tillbaka till startsidan",
    backHomeUrl: "/sv/",
    errorCode: "404"
  }
};

const currentContent = errorContent[lang] || errorContent.en;
---

<Layout title={currentContent.title} description={currentContent.description}>
  <Header />
  
  <main class="error-page">
    <div class="error-page__container container">
      <div class="error-page__content">
        <div class="error-page__error-code">
          {currentContent.errorCode}
        </div>
        
        <h1 class="error-page__title">
          {currentContent.title}
        </h1>
        
        <p class="error-page__subtitle">
          {currentContent.subtitle}
        </p>
        
        <p class="error-page__description">
          {currentContent.description}
        </p>
        
        <div class="error-page__actions">
          <a href={currentContent.backHomeUrl} class="error-page__button">
            {currentContent.backHome}
          </a>
        </div>
      </div>
    </div>
  </main>
  
  <Footer />
</Layout>


